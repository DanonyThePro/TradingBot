<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: monospace;
      font-size: 200%;
      margin: 2%;
      background-color: #222222;
      color: #eeeeee;
    }
    /* #chartContainer {
      width: 30%;
      height: 30%;
    } */
    #myChart {
      display: block;
      width: 80vw;
    }
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/luxon/3.7.1/luxon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@^1.3.1"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/3.1.0/chartjs-plugin-annotation.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial@0.2.1/dist/chartjs-chart-financial.min.js"></script>


  <script>
    async function update() {
      try {
        const response = await fetch("/reload");
        const data = await response.json();
        document.getElementById("current_price").innerText = `Current Price: ${data["Current Price"]}`;
        document.getElementById("last_check").innerText = `Last Check: ${data["Last Check"]}`;
      }
      catch(err) {
        console.error("Error fetching price:", err);
      }
    }

    setInterval(update, 5000);
    update();
  </script>

  <title>Bot Status</title>
</head>
<body>

  <h1>Bot Status</h1>
  <p>status: {{ status }} </p>
  <p>symbol: {{ symbol }} </p>
  <p id="current_price">
    Current Price: {{ current_price }}
  </p>
  <p>Entry Price: {{ entry_price }} </p>
  <p>Stop Loss: {{ stop_loss }} </p>
  <p>Take Profit: {{ take_profit }} </p>
  <p>Balance: {{ balance }} </p>
  <p>P&L(%): {{ pnl_percent }} </p>
  <p>P&L($): {{ pnl_dollar }} </p>
  <p id="last_check">
    Last Check: {{ last_check }}
  </p>

  <div id="chartContainer">
      <canvas id="myChart">

      </canvas>
  </div>


  <script src="{{ url_for('static', filename='chart_script.js') }}"></script>

</body>
</html>